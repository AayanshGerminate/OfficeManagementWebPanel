<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" th:lang="en">
<meta http-equiv="content-type" content="text/html;charset=UTF-8" />

<head th:replace="admin/common/layout :: admin-header-link"></head>

<body>
	<!-- Begin page -->
	<div id="wrapper">
		<!-- Top Bar Start -->
		<div class="topbar" th:replace="admin/common/layout :: admin-navbar"></div>
		<!-- Top Bar End -->
		<!-- ========== Left Sidebar Start ========== -->
		<div class="left side-menu"
			th:replace="admin/common/layout :: admin-sidebar"></div>
		<!-- Left Sidebar End -->
		<!-- ============================================================== -->
		<!-- Start right Content here -->
		<!-- ============================================================== -->
		<div class="content-page">
			<!-- Start content -->
			<div class="content">
				<div class="container-fluid">
					<div class="row">
						<div class="col-sm-12">
							<!-- test -->
							<div class="page-title-box">
								<div class="card m-b-20">
									<div class="card-body">
										<div class="row ">
											<div class="col-md-12 m-b-15">
												<h4 class="mt-0 header-title">
													Intern Income Details
													<button class="btn btn-primary btn-md m-1" type="button"
														data-toggle="modal" data-target="#addModal"
														style="float: right;">New Intern</button>

												</h4>
											</div>
											<div class="col-md-12 table-responsive">

												<table class=" table table-striped dt-responsive nowrap"
													id="datatable-buttons"
													style="border-collapse: collapse; border-spacing: 0; width: 100%;">
													<thead>
														<tr>

															<th>Action</th>
															<th>Name</th>
															<th>Email</th>
															<th>Contact</th>
															<th>Payment Mode</th>
															<th>College</th>
															<th>Type</th>
															<th>Technology</th>
															<th>Paid Amount</th>
															<th>Remaining Amount</th>
															<th>From Date</th>
															<th>To Date</th>
															<th>Status</th>
															<th>Address</th>


															<!-- <th>Country Name</th> -->


														</tr>
													</thead>
													<tbody id="showData">
													</tbody>
												</table>
											</div>
										</div>
									</div>
								</div>
							</div>

						</div>
					</div>
					<div class="modal fade " id="addModal" tabindex="-1" role="dialog"
						aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
						<div
							class="modal-dialog modal-lg modal-dialog-centered modal-dialog-centered">
							<div class="modal-content">
								<div class="modal-header">
									<h5 class="modal-title" id="exampleModalCenterTitle">Add
										Intern Details</h5>
									<button class="close" type="button" data-dismiss="modal"
										aria-label="Close">
										<span aria-hidden="true">×</span>
									</button>
								</div>
								<div class="modal-body">
									<form id="insert">
										<div class="row">

											<div class="col-md-4 mt-3">

												<label>Name</label> <input class="form-control " type="text"
													required name="name" placeholder="Name"
													pattern="[a-zA-Z]{1}[a-zA-Z ]*$"
													title="Only alphabets and spaces allowed">
											</div>

											<div class="col-md-4 mt-3">

												<label>Email</label> <input class="form-control"
													type="email" name="email" placeholder="Email"
													pattern="[a-zA-Z0-9]{1}[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$"
													title="Email pattern is incorrect" required>

											</div>
											<div class="col-md-4 mt-3">

												<label>Phone Number</label> <input class="form-control "
													placeholder="Phone No." type="text" name="phone"
													pattern="[7-9]{1}[0-9]{9}" maxlength="10"
													title="mobile number must start from 7-9 and 10 digit"
													required>

											</div> 
											<div class="col-md-4 mt-3">

												<label>College</label> <input class="form-control "
													placeholder="College Name" type="text" required
													name="college" pattern="[a-zA-Z0-9\s]+"
													title="Only alphabets ,number and space allowed">

											</div>
											<div class="col-md-4 mt-3">

												<label>Technology</label> <input class="form-control "
													placeholder="Technology" type="text" required
													name="technology" pattern="[a-zA-Z0-9\s]+"
													title="Only alphabets ,number and space allowed">

											</div>

											<div class="col-md-4 mt-3">


												<label for="name">Tenure from</label> <input
													class="form-control datepicker hasDatepicker" required
													name="fromDate" type="date">
											</div>

											<div class="col-md-4 mt-3">
												<label for="comment">TO</label> <input type="date"
													class="form-control datepicker hasDatepicker"
													name="toDate" required >
											</div>
											<div class="col-md-4 mt-3">
												<label>Payment Mode</label> <select  class="form-control"
													name="paymentMode" required="required">
													<option value="">Payment Mode</option>
													<option value="cash">CASH</option>
													<option value="neft">NEFT</option>
													<option value="imps">IMPS</option>
													<option value="cheque">CHEQUE</option>
													<option value="paytm">PAYTM</option>
													<option value="bhim upi">BHIM UPI</option>
													<option value="phone pay">PHONE PAY</option>
													<option value="google pay">GOOGLE PAY</option>
												</select>
											</div>

											
											<div class="col-md-4 mt-3">
												<label>Status</label> <select name="status"
													class="form-control " required>
													<option>Status</option>
													<option value="open">Open</option>
													<option value="close">Close</option>
												</select>
											</div>
											<div class="col-md-4 mt-3">
												<label>Type</label> <select name="type"
													class="form-control " required>
													<option value="">Select Type</option>
													<option value="college">College</option>
													<option value="industrial">Industrial</option>
												</select>
											</div>
											<div class="col-md-4 mt-3">
												<label>Remain Amount</label> <input class="form-control "
													type="text" name="remainingAmount"
													placeholder="Remaining Amount" pattern="[0-9]+">
											</div>
											<div class="col-md-4 mt-3">
												<label>Paid Amount</label> <input class="form-control "
													type="text" placeholder="Paid Amount" name="paidAmount"
													pattern="[0-9]+">
											</div>

											<div class="col-md-12 mt-3">

												<label>Address</label>
												<textarea class="form-control " rows="4" cols="4" name="address"
													title="Only alphabets ,number and space allowed"
													placeholder="Address" required></textarea>

											</div>

											<div class="col-md-12 modal-footer mt-3">
												<button class="btn btn-secondary" type="button"
													data-dismiss="modal">Close</button>
												<input class="btn btn-primary ml-2 submit" type="submit"
													value="Save">
											</div>
										</div>

									</form>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="modal fade " id="editModal" tabindex="-1" role="dialog"
					aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
					<div
						class="modal-dialog modal-lg modal-dialog-centered modal-dialog-centered">
						<div class="modal-content">
							<div class="modal-header">
								<h5 class="modal-title" id="exampleModalCenterTitle">Edit
									Lead Details</h5>
								<button class="close" type="button" data-dismiss="modal"
									aria-label="Close">
									<span aria-hidden="true">×</span>
								</button>
							</div>
							<div class="modal-body">
								<form id="update">
									<div class="row">

											<div class="col-md-4 mt-3">
<input type="hidden" name="id" id="internId">

												<label>Name</label> <input class="form-control " type="text"
													required name="name" placeholder="Name"
													pattern="[a-zA-Z]{1}[a-zA-Z ]*$" id="name"
													title="Only alphabets and spaces allowed">
											</div>

											<div class="col-md-4 mt-3">

												<label>Email</label> <input class="form-control"
													type="email" name="email" placeholder="Email" id="email"
													pattern="[a-zA-Z0-9]{1}[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$"
													title="Email pattern is incorrect" required>

											</div>
											<div class="col-md-4 mt-3">

												<label>Phone Number</label> <input class="form-control "
													placeholder="Phone No." type="text" name="phone" id="phone"
													pattern="[7-9]{1}[0-9]{9}" maxlength="10"
													title="mobile number must start from 7-9 and 10 digit"
													required>

											</div> 
											<div class="col-md-4 mt-3">

												<label>College</label> <input class="form-control "
													placeholder="College Name" type="text" required id="college"
													name="college" pattern="[a-zA-Z0-9\s]+"
													title="Only alphabets ,number and space allowed">

											</div>
											<div class="col-md-4 mt-3">

												<label>Technology</label> <input class="form-control "
													placeholder="Technology" type="text" required id="technology"
													name="technology" pattern="[a-zA-Z0-9\s]+"
													title="Only alphabets ,number and space allowed">

											</div>

											<div class="col-md-4 mt-3">


												<label for="name">Tenure from</label> <input
													class="form-control datepicker hasDatepicker" required id="fromDate"
													name="fromDate" type="date">
											</div>

											<div class="col-md-4 mt-3">
												<label for="comment">TO</label> <input type="date" id="toDate"
													class="form-control datepicker hasDatepicker"
													name="toDate" required >
											</div>
											<div class="col-md-4 mt-3">
												<label>Payment Mode</label> <select  class="form-control" id="paymentMode"
													name="paymentMode" required="required">
													<option value="">Payment Mode</option>
													<option value="cash">CASH</option>
													<option value="neft">NEFT</option>
													<option value="imps">IMPS</option>
													<option value="cheque">CHEQUE</option>
													<option value="paytm">PAYTM</option>
													<option value="bhim upi">BHIM UPI</option>
													<option value="phone pay">PHONE PAY</option>
													<option value="google pay">GOOGLE PAY</option>
												</select>
											</div>

											
											<div class="col-md-4 mt-3">
												<label>Status</label> <select id="status" name="status"
													class="form-control " required>
													<option>Status</option>
													<option value="open">Open</option>
													<option value="close">Close</option>
												</select>
											</div>
											<div class="col-md-4 mt-3">
												<label>Type</label> <select id="type" name="type"
													class="form-control " required>
													<option value="">Select Type</option>
													<option value="college">College</option>
													<option value="industrial">Industrial</option>
												</select>
											</div>
											<div class="col-md-4 mt-3">
												<label>Remain Amount</label> <input id="remainingAmount" class="form-control "
													type="text" name="remainingAmount"
													placeholder="Remaining Amount" pattern="[0-9]+">
											</div>
											<div class="col-md-4 mt-3">
												<label>Paid Amount</label> <input class="form-control "
													type="text" placeholder="Paid Amount" id="paidAmount" name="paidAmount"
													pattern="[0-9]+">
											</div>

											<div class="col-md-12 mt-3">

												<label>Address</label>
												<textarea class="form-control " rows="4" cols="4" name="address"
													title="Only alphabets ,number and space allowed"
													placeholder="Address" id="address" required></textarea>

											</div>

											<div class="col-md-12 modal-footer mt-3">
												<button class="btn btn-secondary" type="button"
													data-dismiss="modal">Close</button>
												<input class="btn btn-primary ml-2 submit" type="submit"
													value="Save">
											</div>
										</div>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	</div>
	<div th:replace="admin/common/layout :: admin-footer-link"></div>
	<script type="text/javascript">
		$('document').ready(function() {
			showAllLeadList();
		});

		function showAllLeadList() {
			$('#datatable-buttons').DataTable().destroy();
			$
					.ajax({

						type : "ajax",
						dataType : 'json',
						url : "/fetch-all-intern-list",
						method : 'GET',
						async : false,
						dataType : 'json',
						success : function(data) {

							var html = '';
							var i;
							for (i = 0; i < data.length; i++) {

								

								var date = new Date(data[i].fromDate);
								var from_dd = date.getDate();
								var from_mm = date.getMonth() + 1;
								var from_yyyy = date.getFullYear();
								var fromDate = from_dd + '-' + from_mm + '-'
										+ from_yyyy;

								var date = new Date(data[i].toDate);
								var from_dd = date.getDate();
								var from_mm = date.getMonth() + 1;
								var from_yyyy = date.getFullYear();
								var toDate = from_dd + '-' + from_mm + '-'
										+ from_yyyy;
								
								html += ' <tr>'
										+

										'<td>'
										+ '<a class="text-success mr-2 edit" data="' + data[i].id + '" href="javascript:;"><i class="dripicons-document-edit"></i></a>'
										+

										' <a class="text-danger mr-2 delete" data="' + data[i].id + '" href="javascript:;"><i class="dripicons-document-delete"></i></a>'
										+ '</td>' +
										//                         '<td>'+activityStatus+'</td>'+
									
															
										'<td>'
							
										+ data[i].name
										+ '</td>'
										+ '<td>'
										+ data[i].email
										+ '</td>'

										+ '<td>'
										+ data[i].phone
										+ '</td>'
										+ '<td>'
										+ data[i].paymentMode
										+ '</td>'
										+ '<td>'
										+ data[i].college
										+ '</td>'
										
										+ '<td>'
										+ data[i].type
										+ '</td>'
										+ '<td>'
										+ data[i].technology
										+ '</td>'
										+ '<td>'
										+ data[i].paidAmount
										+ '</td>'
										
										+ '<td>'
										+ data[i].remainingAmount
										+ '</td>'
										+ '<td>'
										+ fromDate
										+ '</td>'
										+ '<td>'
										+toDate
										+ '</td>'
										+ '<td>'
										+ data[i].status
										+ '</td>'
										+ '<td>'
										+ data[i].address
										+ '</td>'
										+ ' </tr>';

							}
							$('#showData').html(html);

							$('#datatable-buttons')
									.DataTable({
										destroy : true,
										lengthChange : false,
										sort : [ 2, "asc" ],
										buttons : [ 'copy', 'excel', 'colvis' ]
									})
									.buttons()
									.container()
									.appendTo(
											'#datatable-buttons_wrapper .col-md-6:eq(0)');

						},
						error : function() {
							alert('could not get data from database');
						}
					});
		}

		$(document).on('submit', '#insert', function(e) {
			e.preventDefault();
			$.ajax({
				type : "ajax",
				method : "POST",
				url : "/save-intern",
				data : new FormData(this),
				processData : false,
				contentType : false,
				cache : false,
				beforeSend : function() {
					$(".submit").prop('disabled', true);
				},

				success : function(data) {
					$(".submit").prop('disabled', false);
					$('#insert')[0].reset();
					$('#addModal').modal('hide');
					showAllLeadList();
				},
				error : function() {
					alert('could not insert');
				}
			});
		});

		$('#showData').on('click', '.edit', function() {
			var id = $(this).attr('data');
			$('#editModal').modal('show');

			$.ajax({
				type : 'ajax',
				method : 'GET',
				url : "/get-intern",
				data : {
					Id : id
				},
				async : false,
				dataType : 'json',
				success : function(data) {
				
					$('input[id=internId]').val(data.id);
					$('input[id=name]').val(data.name);
					$('input[id=email]').val(data.email);
					$('input[id=phone]').val(data.phone);
					$('select[id=paymentMode]').val(data.paymentMode);
					$('select[id=status]').val(data.status);
					$('input[id=college]').val(data.college);
					$('select[id=type]').val(data.type);
					$('input[id=technology]').val(data.technology);
					$('input[id=remainingAmount]').val(data.remainingAmount);
					$('input[id=paidAmount]').val(data.paidAmount);
					$('input[id=fromDate]').val(data.fromDate);
					$('input[id=toDate]').val(data.toDate);
					

					$('textarea[id=address]').val(data.address);
					

				},
				error : function() {
					alert('Could not Edit Data');
				}
			});
		});

		$(document).on('submit', '#update', function(e) {

			e.preventDefault();

			$.ajax({
				url : "/update-intern",
				method : 'POST',
				data : new FormData(this),
				contentType : false,
				processData : false,
				cache : false,
				beforeSend : function() {

					$(".submit").prop('disabled', true);
				},

				success : function(data) {
					$(".submit").prop('disabled', false);
					$('#update')[0].reset();
					$('#editModal').modal('hide');

					showAllLeadList();

				},
				error : function() {
					/*alert('could not insert');*/
				}
			});

		});

		$(document).on('click', '.delete', function() {
			var Id = $(this).attr('data');
			if (confirm('Are you want to delete this?'))
				$.ajax({
					method : "POST",
					url : "/delete-intern",
					data : {
						Id : Id
					},
					success : function(data) {
						showAllLeadList();
					},
					error : function() {
						alert('could not delete');
					}
				});
		});
	</script>
</body>

</html>